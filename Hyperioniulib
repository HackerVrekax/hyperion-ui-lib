-- Inspired by Hyperion Lib GUI
-- Version: v1.0

local Library = {}
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

getgenv().Toggles = {}
getgenv().Options = {}
getgenv().Library = Library


Library.Flags = {}
Library.FlagsFile = "LibraryConfig.json"
Library.CurrentTheme = "Dark"
Library.Themes = {
    Dark = {
        Main = Color3.fromRGB(25, 25, 25),
        Background = Color3.fromRGB(35, 35, 35),
        Topbar = Color3.fromRGB(45, 45, 45),
        Element = Color3.fromRGB(55, 55, 55),
        ElementHover = Color3.fromRGB(65, 65, 65),
        Accent = Color3.fromRGB(0, 120, 255),
        Text = Color3.fromRGB(255, 255, 255),
        TextDisabled = Color3.fromRGB(150, 150, 150),
        Red = Color3.fromRGB(255, 50, 50),
        Green = Color3.fromRGB(50, 255, 50),
        Blue = Color3.fromRGB(50, 150, 255),
    },
    Light = {
        Main = Color3.fromRGB(240, 240, 240),
        Background = Color3.fromRGB(220, 220, 220),
        Topbar = Color3.fromRGB(200, 200, 200),
        Element = Color3.fromRGB(180, 180, 180),
        ElementHover = Color3.fromRGB(160, 160, 160),
        Accent = Color3.fromRGB(0, 100, 200),
        Text = Color3.fromRGB(0, 0, 0),
        TextDisabled = Color3.fromRGB(100, 100, 100),
        Red = Color3.fromRGB(200, 0, 0),
        Green = Color3.fromRGB(0, 150, 0),
        Blue = Color3.fromRGB(0, 100, 200),
    }
}

function Library:CreateWindow(options)
    options = options or {}
    local window = {}
    
    window.Title = options.Title or "Library"
    window.Footer = options.Footer or ""
    window.Size = options.Size or UDim2.new(0, 600, 0, 400)
    window.Position = options.Position or UDim2.new(0.5, -300, 0.5, -200)
    window.NotifySide = options.NotifySide or "Right"
    window.Dragging = { false, false }
    
    window.Gui = Instance.new("ScreenGui")
    window.Gui.Name = "LibraryGui"
    window.Gui.ResetOnSpawn = false
    window.Gui.Parent = game:GetService("CoreGui")
    
    window.Main = Instance.new("Frame")
    window.Main.Name = "Main"
    window.Main.Size = window.Size
    window.Main.Position = window.Position
    window.Main.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Main
    window.Main.BorderSizePixel = 0
    window.Main.ClipsDescendants = true
    window.Main.Parent = window.Gui
    
    window.Shadow = Instance.new("ImageLabel")
    window.Shadow.Name = "Shadow"
    window.Shadow.Size = UDim2.new(1, 40, 1, 40)
    window.Shadow.Position = UDim2.new(0, -20, 0, -20)
    window.Shadow.BackgroundTransparency = 1
    window.Shadow.Image = "rbxassetid://6015897843"
    window.Shadow.ImageColor3 = Color3.new(0, 0, 0)
    window.Shadow.ImageTransparency = 0.5
    window.Shadow.ScaleType = Enum.ScaleType.Slice
    window.Shadow.SliceCenter = Rect.new(10, 10, 118, 118)
    window.Shadow.Parent = window.Main
    
    window.Topbar = Instance.new("Frame")
    window.Topbar.Name = "Topbar"
    window.Topbar.Size = UDim2.new(1, 0, 0, 30)
    window.Topbar.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Topbar
    window.Topbar.BorderSizePixel = 0
    window.Topbar.Parent = window.Main
    
    window.TitleLabel = Instance.new("TextLabel")
    window.TitleLabel.Name = "Title"
    window.TitleLabel.Size = UDim2.new(1, -40, 1, 0)
    window.TitleLabel.Position = UDim2.new(0, 10, 0, 0)
    window.TitleLabel.BackgroundTransparency = 1
    window.TitleLabel.Text = window.Title
    window.TitleLabel.TextColor3 = Library.Themes[Library.CurrentTheme].Text
    window.TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    window.TitleLabel.Font = Enum.Font.GothamSemibold
    window.TitleLabel.TextSize = 16
    window.TitleLabel.Parent = window.Topbar
    
    window.CloseButton = Instance.new("TextButton")
    window.CloseButton.Name = "CloseButton"
    window.CloseButton.Size = UDim2.new(0, 30, 1, 0)
    window.CloseButton.Position = UDim2.new(1, -30, 0, 0)
    window.CloseButton.BackgroundTransparency = 1
    window.CloseButton.Text = "âœ•"
    window.CloseButton.TextColor3 = Library.Themes[Library.CurrentTheme].Text
    window.CloseButton.Font = Enum.Font.GothamSemibold
    window.CloseButton.TextSize = 20
    window.CloseButton.Parent = window.Topbar
    
    window.CloseButton.MouseButton1Click:Connect(function()
        window.Main.Visible = not window.Main.Visible
    end)
    
    window.TabContainer = Instance.new("Frame")
    window.TabContainer.Name = "TabContainer"
    window.TabContainer.Size = UDim2.new(1, 0, 0, 30)
    window.TabContainer.Position = UDim2.new(0, 0, 0, 30)
    window.TabContainer.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Background
    window.TabContainer.BorderSizePixel = 0
    window.TabContainer.Parent = window.Main
    
    window.TabList = Instance.new("UIListLayout")
    window.TabList.FillDirection = Enum.FillDirection.Horizontal
    window.TabList.HorizontalAlignment = Enum.HorizontalAlignment.Left
    window.TabList.VerticalAlignment = Enum.VerticalAlignment.Center
    window.TabList.Padding = UDim.new(0, 5)
    window.TabList.Parent = window.TabContainer
    
    window.PageContainer = Instance.new("Frame")
    window.PageContainer.Name = "PageContainer"
    window.PageContainer.Size = UDim2.new(1, 0, 1, -60)
    window.PageContainer.Position = UDim2.new(0, 0, 0, 60)
    window.PageContainer.BackgroundTransparency = 1
    window.PageContainer.Parent = window.Main
    
    window.Tabs = {}
    window.Pages = {}
    
    function window:AddTab(name, icon)
        local tab = {}
        tab.Name = name
        tab.Icon = icon or "â˜…"
        tab.Buttons = {}
        
        tab.Button = Instance.new("TextButton")
        tab.Button.Name = name .. "Button"
        tab.Button.Size = UDim2.new(0, 80, 0, 25)
        tab.Button.Position = UDim2.new(0, #window.Tabs * 85, 0, 2.5)
        tab.Button.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
        tab.Button.Text = tab.Icon .. " " .. name
        tab.Button.TextColor3 = Library.Themes[Library.CurrentTheme].Text
        tab.Button.Font = Enum.Font.Gotham
        tab.Button.TextSize = 14
        tab.Button.Parent = window.TabContainer
        
        tab.Page = Instance.new("ScrollingFrame")
        tab.Page.Name = name .. "Page"
        tab.Page.Size = UDim2.new(1, -20, 1, -20)
        tab.Page.Position = UDim2.new(0, 10, 0, 10)
        tab.Page.BackgroundTransparency = 1
        tab.Page.BorderSizePixel = 0
        tab.Page.ScrollBarThickness = 5
        tab.Page.ScrollBarImageColor3 = Library.Themes[Library.CurrentTheme].Accent
        tab.Page.CanvasSize = UDim2.new(0, 0, 0, 0)
        tab.Page.AutomaticCanvasSize = Enum.AutomaticSize.Y
        tab.Page.Visible = #window.Tabs == 0
        tab.Page.Parent = window.PageContainer
        
        tab.Layout = Instance.new("UIListLayout")
        tab.Layout.FillDirection = Enum.FillDirection.Vertical
        tab.Layout.HorizontalAlignment = Enum.HorizontalAlignment.Left
        tab.Layout.VerticalAlignment = Enum.VerticalAlignment.Top
        tab.Layout.Padding = UDim.new(0, 10)
        tab.Layout.Parent = tab.Page
        
        tab.Button.MouseButton1Click:Connect(function()
            for _, otherTab in pairs(window.Tabs) do
                otherTab.Page.Visible = false
                otherTab.Button.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
            end
            tab.Page.Visible = true
            tab.Button.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Accent
        end)
        
        function tab:AddLeftGroupbox(name, icon)
            return self:CreateGroupbox(name, icon, "Left")
        end
        
        function tab:AddRightGroupbox(name, icon)
            return self:CreateGroupbox(name, icon, "Right")
        end
        
        function tab:CreateGroupbox(name, icon, side)
            local groupbox = {}
            groupbox.Name = name
            groupbox.Icon = icon or "ðŸ“¦"
            groupbox.Side = side
            groupbox.Elements = {}
            
            groupbox.Frame = Instance.new("Frame")
            groupbox.Frame.Name = name .. "Groupbox"
            groupbox.Frame.Size = UDim2.new(side == "Left" and 0.48 or 0.48, 0, 0, 0)
            groupbox.Frame.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Background
            groupbox.Frame.BorderSizePixel = 0
            groupbox.Frame.AutomaticSize = Enum.AutomaticSize.Y
            groupbox.Frame.Parent = tab.Page
            
            groupbox.Title = Instance.new("TextLabel")
            groupbox.Title.Name = "Title"
            groupbox.Title.Size = UDim2.new(1, -20, 0, 25)
            groupbox.Title.Position = UDim2.new(0, 10, 0, 5)
            groupbox.Title.BackgroundTransparency = 1
            groupbox.Title.Text = groupbox.Icon .. " " .. groupbox.Name
            groupbox.Title.TextColor3 = Library.Themes[Library.CurrentTheme].Accent
            groupbox.Title.TextXAlignment = Enum.TextXAlignment.Left
            groupbox.Title.Font = Enum.Font.GothamSemibold
            groupbox.Title.TextSize = 15
            groupbox.Title.Parent = groupbox.Frame
            
            groupbox.Container = Instance.new("Frame")
            groupbox.Container.Name = "Container"
            groupbox.Container.Size = UDim2.new(1, -20, 0, 0)
            groupbox.Container.Position = UDim2.new(0, 10, 0, 30)
            groupbox.Container.BackgroundTransparency = 1
            groupbox.Container.AutomaticSize = Enum.AutomaticSize.Y
            groupbox.Container.Parent = groupbox.Frame
            
            groupbox.Layout = Instance.new("UIListLayout")
            groupbox.Layout.FillDirection = Enum.FillDirection.Vertical
            groupbox.Layout.HorizontalAlignment = Enum.HorizontalAlignment.Left
            groupbox.Layout.VerticalAlignment = Enum.VerticalAlignment.Top
            groupbox.Layout.Padding = UDim.new(0, 5)
            groupbox.Layout.Parent = groupbox.Container
            
            function groupbox:AddToggle(idx, options)
                return self:CreateToggle(idx, options)
            end
            
            function groupbox:AddButton(options)
                return self:CreateButton(options)
            end
            
            function groupbox:AddSlider(idx, options)
                return self:CreateSlider(idx, options)
            end
            
            function groupbox:AddDropdown(idx, options)
                return self:CreateDropdown(idx, options)
            end
            
            function groupbox:AddInput(idx, options)
                return self:CreateInput(idx, options)
            end
            
            function groupbox:AddLabel(text, wrap, idx)
                return self:CreateLabel(text, wrap, idx)
            end
            
            function groupbox:AddDivider()
                return self:CreateDivider()
            end
            
            function groupbox:CreateToggle(idx, options)
                local toggle = {}
                toggle.Idx = idx
                toggle.Text = options.Text or "Toggle"
                toggle.Tooltip = options.Tooltip or ""
                toggle.Default = options.Default or false
                toggle.Value = toggle.Default
                toggle.Callback = options.Callback or function() end
                
                toggle.Frame = Instance.new("Frame")
                toggle.Frame.Name = idx .. "Toggle"
                toggle.Frame.Size = UDim2.new(1, 0, 0, 25)
                toggle.Frame.BackgroundTransparency = 1
                toggle.Frame.Parent = groupbox.Container
                
                toggle.Button = Instance.new("TextButton")
                toggle.Button.Name = "Button"
                toggle.Button.Size = UDim2.new(0, 40, 0, 20)
                toggle.Button.Position = UDim2.new(0, 0, 0.5, -10)
                toggle.Button.BackgroundColor3 = toggle.Value and Library.Themes[Library.CurrentTheme].Green or Library.Themes[Library.CurrentTheme].Red
                toggle.Button.Text = ""
                toggle.Button.Parent = toggle.Frame
                
                toggle.Indicator = Instance.new("Frame")
                toggle.Indicator.Name = "Indicator"
                toggle.Indicator.Size = UDim2.new(0, 16, 0, 16)
                toggle.Indicator.Position = toggle.Value and UDim2.new(0, 22, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
                toggle.Indicator.BackgroundColor3 = Color3.new(1, 1, 1)
                toggle.Indicator.Parent = toggle.Button
                

                toggle.TextLabel = Instance.new("TextLabel")
                toggle.TextLabel.Name = "Text"
                toggle.TextLabel.Size = UDim2.new(1, -45, 1, 0)
                toggle.TextLabel.Position = UDim2.new(0, 45, 0, 0)
                toggle.TextLabel.BackgroundTransparency = 1
                toggle.TextLabel.Text = toggle.Text
                toggle.TextLabel.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                toggle.TextLabel.TextXAlignment = Enum.TextXAlignment.Left
                toggle.TextLabel.Font = Enum.Font.Gotham
                toggle.TextLabel.TextSize = 14
                toggle.TextLabel.Parent = toggle.Frame
                
 
                function toggle:SetValue(value)
                    self.Value = value
                    self.Button.BackgroundColor3 = value and Library.Themes[Library.CurrentTheme].Green or Library.Themes[Library.CurrentTheme].Red
                    self.Indicator.Position = value and UDim2.new(0, 22, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
                    self.Callback(value)
                    Toggles[idx] = self
                end
                

                toggle.Button.MouseButton1Click:Connect(function()
                    toggle:SetValue(not toggle.Value)
                end)
                

                toggle:SetValue(toggle.Default)
                
                getgenv().Toggles[idx] = toggle
                return toggle
            end
            

            function groupbox:CreateButton(options)
                local button = {}
                button.Text = options.Text or "Button"
                button.Func = options.Func or function() end
                button.Tooltip = options.Tooltip or ""
                

                button.Button = Instance.new("TextButton")
                button.Button.Name = button.Text .. "Button"
                button.Button.Size = UDim2.new(1, 0, 0, 25)
                button.Button.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
                button.Button.Text = button.Text
                button.Button.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                button.Button.Font = Enum.Font.Gotham
                button.Button.TextSize = 14
                button.Button.Parent = groupbox.Container
                
                button.Button.MouseButton1Click:Connect(function()
                    button.Func()
                end)
                
                button.Button.MouseEnter:Connect(function()
                    button.Button.BackgroundColor3 = Library.Themes[Library.CurrentTheme].ElementHover
                end)
                
                button.Button.MouseLeave:Connect(function()
                    button.Button.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
                end)
                
                function button:AddButton(subOptions)
                    return groupbox:CreateButton(subOptions)
                end
                
                return button
            end
            

            function groupbox:CreateSlider(idx, options)
                local slider = {}
                slider.Idx = idx
                slider.Text = options.Text or "Slider"
                slider.Min = options.Min or 0
                slider.Max = options.Max or 100
                slider.Default = options.Default or 0
                slider.Value = slider.Default
                slider.Rounding = options.Rounding or 1
                slider.Suffix = options.Suffix or ""
                slider.Callback = options.Callback or function() end
                

                slider.Frame = Instance.new("Frame")
                slider.Frame.Name = idx .. "Slider"
                slider.Frame.Size = UDim2.new(1, 0, 0, 40)
                slider.Frame.BackgroundTransparency = 1
                slider.Frame.Parent = groupbox.Container
                
    
                slider.TextLabel = Instance.new("TextLabel")
                slider.TextLabel.Name = "Text"
                slider.TextLabel.Size = UDim2.new(1, -50, 0, 20)
                slider.TextLabel.Position = UDim2.new(0, 0, 0, 0)
                slider.TextLabel.BackgroundTransparency = 1
                slider.TextLabel.Text = slider.Text .. ": " .. slider.Value .. slider.Suffix
                slider.TextLabel.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                slider.TextLabel.TextXAlignment = Enum.TextXAlignment.Left
                slider.TextLabel.Font = Enum.Font.Gotham
                slider.TextLabel.TextSize = 14
                slider.TextLabel.Parent = slider.Frame
                

                slider.Slider = Instance.new("Frame")
                slider.Slider.Name = "Slider"
                slider.Slider.Size = UDim2.new(1, 0, 0, 10)
                slider.Slider.Position = UDim2.new(0, 0, 0, 25)
                slider.Slider.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
                slider.Slider.Parent = slider.Frame
                

                slider.Fill = Instance.new("Frame")
                slider.Fill.Name = "Fill"
                slider.Fill.Size = UDim2.new((slider.Value - slider.Min) / (slider.Max - slider.Min), 0, 1, 0)
                slider.Fill.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Accent
                slider.Fill.Parent = slider.Slider
                

                slider.Drag = Instance.new("TextButton")
                slider.Drag.Name = "Drag"
                slider.Drag.Size = UDim2.new(1, 0, 1, 0)
                slider.Drag.BackgroundTransparency = 1
                slider.Drag.Text = ""
                slider.Drag.Parent = slider.Slider
                
                local dragging = false
                
                local function updateSlider(input)
                    local pos = UIS:GetMouseLocation().X - slider.Slider.AbsolutePosition.X
                    local size = slider.Slider.AbsoluteSize.X
                    local percent = math.clamp(pos / size, 0, 1)
                    local value = slider.Min + (slider.Max - slider.Min) * percent
                    value = math.round(value * (10 ^ slider.Rounding)) / (10 ^ slider.Rounding)
                    slider:SetValue(value)
                end
                
                slider.Drag.MouseButton1Down:Connect(function()
                    dragging = true
                    updateSlider()
                end)
                
                UIS.InputEnded:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 then
                        dragging = false
                    end
                end)
                
                UIS.InputChanged:Connect(function(input)
                    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                        updateSlider()
                    end
                end)
                
                function slider:SetValue(value)
                    self.Value = math.clamp(value, self.Min, self.Max)
                    self.TextLabel.Text = self.Text .. ": " .. self.Value .. self.Suffix
                    self.Fill.Size = UDim2.new((self.Value - self.Min) / (self.Max - self.Min), 0, 1, 0)
                    self.Callback(self.Value)
                    Options[idx] = self
                end
                
                slider:SetValue(slider.Default)
                
                getgenv().Options[idx] = slider
                return slider
            end
            

            function groupbox:CreateDropdown(idx, options)
                local dropdown = {}
                dropdown.Idx = idx
                dropdown.Text = options.Text or "Dropdown"
                dropdown.Values = options.Values or {}
                dropdown.Default = options.Default or 1
                dropdown.Multi = options.Multi or false
                dropdown.Value = dropdown.Multi and {} or dropdown.Values[dropdown.Default]
                dropdown.Callback = options.Callback or function() end
                
    
                dropdown.Frame = Instance.new("Frame")
                dropdown.Frame.Name = idx .. "Dropdown"
                dropdown.Frame.Size = UDim2.new(1, 0, 0, 30)
                dropdown.Frame.BackgroundTransparency = 1
                dropdown.Frame.Parent = groupbox.Container
                

                dropdown.TextLabel = Instance.new("TextLabel")
                dropdown.TextLabel.Name = "Text"
                dropdown.TextLabel.Size = UDim2.new(0, 80, 1, 0)
                dropdown.TextLabel.BackgroundTransparency = 1
                dropdown.TextLabel.Text = dropdown.Text
                dropdown.TextLabel.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                dropdown.TextLabel.TextXAlignment = Enum.TextXAlignment.Left
                dropdown.TextLabel.Font = Enum.Font.Gotham
                dropdown.TextLabel.TextSize = 14
                dropdown.TextLabel.Parent = dropdown.Frame
                
 
                dropdown.Button = Instance.new("TextButton")
                dropdown.Button.Name = "Button"
                dropdown.Button.Size = UDim2.new(1, -85, 1, 0)
                dropdown.Button.Position = UDim2.new(0, 85, 0, 0)
                dropdown.Button.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
                dropdown.Button.Text = tostring(dropdown.Value)
                dropdown.Button.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                dropdown.Button.Font = Enum.Font.Gotham
                dropdown.Button.TextSize = 14
                dropdown.Button.Parent = dropdown.Frame
                
    
                dropdown.Menu = Instance.new("ScrollingFrame")
                dropdown.Menu.Name = "Menu"
                dropdown.Menu.Size = UDim2.new(1, -85, 0, 0)
                dropdown.Menu.Position = UDim2.new(0, 85, 1, 0)
                dropdown.Menu.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
                dropdown.Menu.BorderSizePixel = 0
                dropdown.Menu.Visible = false
                dropdown.Menu.AutomaticSize = Enum.AutomaticSize.Y
                dropdown.Menu.Parent = dropdown.Frame
                
    
                for i, value in ipairs(dropdown.Values) do
                    local item = Instance.new("TextButton")
                    item.Name = value .. "Item"
                    item.Size = UDim2.new(1, 0, 0, 25)
                    item.BackgroundTransparency = 1
                    item.Text = tostring(value)
                    item.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                    item.Font = Enum.Font.Gotham
                    item.TextSize = 14
                    item.Parent = dropdown.Menu
                    
                    item.MouseButton1Click:Connect(function()
                        if dropdown.Multi then
                            dropdown.Value[value] = not dropdown.Value[value]
                        else
                            dropdown.Value = value
                            dropdown.Button.Text = tostring(value)
                            dropdown.Menu.Visible = false
                        end
                        dropdown.Callback(dropdown.Value)
                    end)
                    
                    item.MouseEnter:Connect(function()
                        item.BackgroundTransparency = 0.5
                    end)
                    
                    item.MouseLeave:Connect(function()
                        item.BackgroundTransparency = 1
                    end)
                end
                
                dropdown.Button.MouseButton1Click:Connect(function()
                    dropdown.Menu.Visible = not dropdown.Menu.Visible
                end)
                
                function dropdown:SetValue(value)
                    if self.Multi then
                        self.Value = value
                    else
                        self.Value = value
                        self.Button.Text = tostring(value)
                    end
                    self.Callback(self.Value)
                    Options[idx] = self
                end
                
                getgenv().Options[idx] = dropdown
                return dropdown
            end
            
       
            function groupbox:CreateInput(idx, options)
                local input = {}
                input.Idx = idx
                input.Text = options.Text or "Input"
                input.Default = options.Default or ""
                input.Value = input.Default
                input.Placeholder = options.Placeholder or ""
                input.Numeric = options.Numeric or false
                input.Callback = options.Callback or function() end
                
         
                input.Frame = Instance.new("Frame")
                input.Frame.Name = idx .. "Input"
                input.Frame.Size = UDim2.new(1, 0, 0, 30)
                input.Frame.BackgroundTransparency = 1
                input.Frame.Parent = groupbox.Container
                

                input.TextLabel = Instance.new("TextLabel")
                input.TextLabel.Name = "Text"
                input.TextLabel.Size = UDim2.new(0, 80, 1, 0)
                input.TextLabel.BackgroundTransparency = 1
                input.TextLabel.Text = input.Text
                input.TextLabel.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                input.TextLabel.TextXAlignment = Enum.TextXAlignment.Left
                input.TextLabel.Font = Enum.Font.Gotham
                input.TextLabel.TextSize = 14
                input.TextLabel.Parent = input.Frame
                

                input.Box = Instance.new("TextBox")
                input.Box.Name = "Box"
                input.Box.Size = UDim2.new(1, -85, 1, 0)
                input.Box.Position = UDim2.new(0, 85, 0, 0)
                input.Box.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
                input.Box.Text = input.Default
                input.Box.PlaceholderText = input.Placeholder
                input.Box.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                input.Box.PlaceholderColor3 = Library.Themes[Library.CurrentTheme].TextDisabled
                input.Box.Font = Enum.Font.Gotham
                input.Box.TextSize = 14
                input.Box.ClearTextOnFocus = false
                input.Box.Parent = input.Frame
                
                input.Box.FocusLost:Connect(function(enterPressed)
                    local text = input.Box.Text
                    if input.Numeric then
                        text = tonumber(text) or 0
                    end
                    input:SetValue(text)
                end)
                
                function input:SetValue(value)
                    self.Value = value
                    self.Box.Text = tostring(value)
                    self.Callback(self.Value)
                    Options[idx] = self
                end
                
                getgenv().Options[idx] = input
                return input
            end
            

            function groupbox:CreateLabel(text, wrap, idx)
                local label = {}
                label.Text = text
                label.Wrap = wrap or false
                

                label.Label = Instance.new("TextLabel")
                label.Label.Name = (idx or "Label") .. "Label"
                label.Label.Size = UDim2.new(1, 0, 0, label.Wrap and 0 or 20)
                label.Label.BackgroundTransparency = 1
                label.Label.Text = text
                label.Label.TextColor3 = Library.Themes[Library.CurrentTheme].Text
                label.Label.TextXAlignment = Enum.TextXAlignment.Left
                label.Label.Font = Enum.Font.Gotham
                label.Label.TextSize = 14
                label.Label.TextWrapped = label.Wrap
                label.Label.AutomaticSize = label.Wrap and Enum.AutomaticSize.Y or Enum.AutomaticSize.None
                label.Label.Parent = groupbox.Container
                
                if idx then
                    getgenv().Options[idx] = label
                end
                
                return label
            end
            

            function groupbox:CreateDivider()
                local divider = {}
                

                divider.Line = Instance.new("Frame")
                divider.Line.Name = "Divider"
                divider.Line.Size = UDim2.new(1, 0, 0, 1)
                divider.Line.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Element
                divider.Line.BorderSizePixel = 0
                divider.Line.Parent = groupbox.Container
                
                return divider
            end
            
            table.insert(groupbox.Elements, groupbox)
            return groupbox
        end
        
        table.insert(window.Tabs, tab)
        return tab
    end
    

    function Library:Notify(options)
        options = options or {}
        local title = options.Title or "Notification"
        local description = options.Description or ""
        local time = options.Time or 3
        
        local notification = Instance.new("Frame")
        notification.Name = "Notification"
        notification.Size = UDim2.new(0, 300, 0, 0)
        notification.Position = window.NotifySide == "Right" and UDim2.new(1, -310, 1, -10) or UDim2.new(0, 10, 1, -10)
        notification.BackgroundColor3 = Library.Themes[Library.CurrentTheme].Background
        notification.BorderSizePixel = 0
        notification.AutomaticSize = Enum.AutomaticSize.Y
        notification.Parent = window.Gui
        
        local titleLabel = Instance.new("TextLabel")
        titleLabel.Name = "Title"
        titleLabel.Size = UDim2.new(1, -20, 0, 25)
        titleLabel.Position = UDim2.new(0, 10, 0, 5)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Text = title
        titleLabel.TextColor3 = Library.Themes[Library.CurrentTheme].Accent
        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
        titleLabel.Font = Enum.Font.GothamSemibold
        titleLabel.TextSize = 16
        titleLabel.Parent = notification
        
        local descLabel = Instance.new("TextLabel")
        descLabel.Name = "Description"
        descLabel.Size = UDim2.new(1, -20, 0, 0)
        descLabel.Position = UDim2.new(0, 10, 0, 30)
        descLabel.BackgroundTransparency = 1
        descLabel.Text = description
        descLabel.TextColor3 = Library.Themes[Library.CurrentTheme].Text
        descLabel.TextXAlignment = Enum.TextXAlignment.Left
        descLabel.Font = Enum.Font.Gotham
        descLabel.TextSize = 14
        descLabel.TextWrapped = true
        descLabel.AutomaticSize = Enum.AutomaticSize.Y
        descLabel.Parent = notification
        
        notification.Size = UDim2.new(0, 300, 0, descLabel.AbsoluteSize.Y + 40)
        
        task.delay(time, function()
            notification:Destroy()
        end)
    end
    

    local function startDrag(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            window.Dragging = { true, input.Position - window.Main.AbsolutePosition }
        end
    end
    
    local function stopDrag(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            window.Dragging[1] = false
        end
    end
    
    local function doDrag(input)
        if window.Dragging[1] and input.UserInputType == Enum.UserInputType.MouseMovement then
            window.Main.Position = UDim2.new(0, input.Position.X - window.Dragging[2].X, 0, input.Position.Y - window.Dragging[2].Y)
        end
    end
    
    window.Topbar.InputBegan:Connect(startDrag)
    window.Topbar.InputEnded:Connect(stopDrag)
    window.Topbar.InputChanged:Connect(doDrag)
    
    UIS.InputChanged:Connect(doDrag)
    
    return window
end


local SaveManager = {}
SaveManager.Library = Library
SaveManager.Folder = "LibraryConfigs"
SaveManager.IgnoreIndexes = {}

function SaveManager:SetLibrary(library)
    self.Library = library
end

function SaveManager:SetFolder(folder)
    self.Folder = folder
    if not isfolder(folder) then
        makefolder(folder)
    end
end

function SaveManager:IgnoreThemeSettings()

end

function SaveManager:SetIgnoreIndexes(indexes)
    self.IgnoreIndexes = indexes or {}
end

function SaveManager:SaveConfig(name)
    local config = {}
    config.Toggles = {}
    config.Options = {}
    
    for idx, toggle in pairs(getgenv().Toggles) do
        if not table.find(self.IgnoreIndexes, idx) then
            config.Toggles[idx] = toggle.Value
        end
    end
    
    for idx, option in pairs(getgenv().Options) do
        if not table.find(self.IgnoreIndexes, idx) then
            if option.Value ~= nil then
                config.Options[idx] = option.Value
            end
        end
    end
    
    local json = game:GetService("HttpService"):JSONEncode(config)
    writefile(self.Folder .. "/" .. name .. ".json", json)
    Library:Notify({
        Title = "Config Saved",
        Description = "Configuration '" .. name .. "' saved successfully!",
        Time = 3
    })
end

function SaveManager:LoadConfig(name)
    local path = self.Folder .. "/" .. name .. ".json"
    if isfile(path) then
        local json = readfile(path)
        local config = game:GetService("HttpService"):JSONDecode(json)
        
        for idx, value in pairs(config.Toggles) do
            if getgenv().Toggles[idx] then
                getgenv().Toggles[idx]:SetValue(value)
            end
        end
        
        for idx, value in pairs(config.Options) do
            if getgenv().Options[idx] then
                if getgenv().Options[idx].SetValue then
                    getgenv().Options[idx]:SetValue(value)
                end
            end
        end
        
        Library:Notify({
            Title = "Config Loaded",
            Description = "Configuration '" .. name .. "' loaded successfully!",
            Time = 3
        })
    end
end

function SaveManager:DeleteConfig(name)
    local path = self.Folder .. "/" .. name .. ".json"
    if isfile(path) then
        delfile(path)
        Library:Notify({
            Title = "Config Deleted",
            Description = "Configuration '" .. name .. "' deleted!",
            Time = 3
        })
    end
end

function SaveManager:GetConfigs()
    local configs = {}
    if isfolder(self.Folder) then
        for _, file in ipairs(listfiles(self.Folder)) do
            local name = file:match("([^/\\]+)%.json$")
            if name then
                table.insert(configs, name)
            end
        end
    end
    return configs
end

function SaveManager:BuildConfigSection(tab)
    local group = tab:AddLeftGroupbox("Config Manager", "ðŸ’¾")
    
    group:AddLabel("Save/Load Configurations", true)
    group:AddDivider()
    
    local configDropdown = group:AddDropdown("ConfigSelector", {
        Text = "Select Config",
        Values = self:GetConfigs(),
        Default = 1,
    })
    
    group:AddInput("ConfigName", {
        Text = "Config Name",
        Default = "NewConfig",
        Placeholder = "Enter config name...",
    })
    
    group:AddButton({
        Text = "Save Config",
        Func = function()
            local name = Options.ConfigName.Value
            if name and name ~= "" then
                self:SaveConfig(name)
                configDropdown:SetValue(self:GetConfigs())
            end
        end
    })
    
    group:AddButton({
        Text = "Load Config",
        Func = function()
            local name = Options.ConfigSelector.Value
            if name then
                self:LoadConfig(name)
            end
        end
    })
    
    group:AddButton({
        Text = "Delete Config",
        Func = function()
            local name = Options.ConfigSelector.Value
            if name then
                self:DeleteConfig(name)
                configDropdown:SetValue(self:GetConfigs())
            end
        end
    })
    
    group:AddButton({
        Text = "Refresh List",
        Func = function()
            configDropdown:SetValue(self:GetConfigs())
        end
    })
end

Library.SaveManager = SaveManager


local ThemeManager = {}
ThemeManager.Library = Library

function ThemeManager:SetLibrary(library)
    self.Library = library
end

function ThemeManager:SetFolder(folder)

end

function ThemeManager:ApplyToTab(tab)
    local group = tab:AddRightGroupbox("Theme Settings", "ðŸŽ¨")
    
    local themes = {}
    for theme in pairs(Library.Themes) do
        table.insert(themes, theme)
    end
    
    group:AddDropdown("ThemeSelector", {
        Text = "Select Theme",
        Values = themes,
        Default = Library.CurrentTheme,
        Callback = function(value)
            Library.CurrentTheme = value

        end
    })
end

Library.ThemeManager = ThemeManager

return Library
